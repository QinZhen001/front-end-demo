(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4612],{7707:(e,t,l)=>{Promise.resolve().then(l.bind(l,4561))},4561:(e,t,l)=>{"use strict";let r;l.r(t),l.d(t,{default:()=>d});var i=l(5155),a=l(2115);let s=0,n=0,o="",c=new Map,h=[],d=()=>{let e=(0,a.useRef)(null),t=!1,l="",d=new Set,f=()=>new Promise((t,l)=>{let i=new Image;i.src="/images/color_block.jpg",i.crossOrigin="Anonymous",i.onload=()=>{r.drawImage(i,0,0,e.current.width,e.current.height),t(!0)}}),g=()=>{r=e.current.getContext("2d",{willReadFrequently:!0});let{left:t,top:l}=e.current.getBoundingClientRect();s=t,n=l},u=(e,t)=>{let l=r.getImageData(e,t,1,1);return"#"+(l.data[0]<<16|l.data[1]<<8|l.data[2]).toString(16).padStart(6,"0")},w=async()=>{let t=e.current.width,l=e.current.height,r=Date.now();for(let e=0;e<t-1;e++)for(let t=0;t<l-1;t++){let l=u(e,t);if(c.has(l))c.get(l).add([e,t]);else{let r=new Set;r.add([e,t]),c.set(l,r)}}for(let[e,t]of c)t.size<=100&&c.delete(e);console.log("cost time ",Date.now()-r),console.log("final map",c)},p=async()=>{g(),await f(),await w()};(0,a.useEffect)(()=>{p()},[]);let v=()=>{if(t){t=!1;return}for(;h.length;){let{color:e,data:t}=h.pop()||{};if(e&&t){for(let l of(r.beginPath(),r.fillStyle=e,t)){let[e,t]=l;r.rect(e,t,1,1)}r.fill(),r.closePath()}}},j=()=>{if(!o)return;let e=c.get(o);for(let t of(l=function(e,t){var l=!1;"#"==e[0]&&(e=e.slice(1),l=!0);var r=parseInt(e,16),i=(r>>16)+100;i>255?i=255:i<0&&(i=0);var a=(r>>8&255)+100;a>255?a=255:a<0&&(a=0);var s=(255&r)+100;return s>255?s=255:s<0&&(s=0),(l?"#":"")+(s|a<<8|i<<16).toString(16)}(o,100),d=e,r.beginPath(),r.fillStyle=l,e)){let[e,l]=t;r.rect(e,l,1,1)}r.fill(),r.closePath(),h.push({color:o,data:e})};return(0,i.jsxs)("div",{children:[(0,i.jsx)("section",{}),(0,i.jsxs)("section",{className:"flex gap-3",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h4",{children:"模特图"}),(0,i.jsx)("img",{src:"/images/model.jpg",width:"300",height:"600"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h4",{children:"色块图（原图）"}),(0,i.jsx)("img",{src:"/images/color_block.jpg",width:"300",height:"600"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h4",{children:"色块图（支持用户hover高亮，点击选中）"}),(0,i.jsx)("div",{className:"relative",children:(0,i.jsx)("canvas",{onMouseMove:e=>{let t=u(Math.floor(e.clientX-s),Math.floor(e.clientY-n));o!==t&&(o=t,c.has(o)&&(v(),j()))},onMouseLeave:()=>{o="",v()},onClick:()=>{for(let e of(t=!0,r.beginPath(),r.fillStyle=l,d)){let[t,l]=e;r.rect(t,l,1,1)}r.fill(),r.closePath(),h.pop(),h.push({color:l,data:d})},width:300,height:600,ref:e})})]})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[8441,1517,7358],()=>t(7707)),_N_E=e.O()}]);