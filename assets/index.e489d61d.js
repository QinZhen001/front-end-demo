import{r as i,a as g,j as a}from"./index.2f1a2300.js";let s,o,p=0,m=0;const T=()=>{const c=i.exports.useRef(null),l=i.exports.useRef(null),r=i.exports.useRef("up"),f=()=>new Promise((e,t)=>{const n=new Image;n.src="https://fullapp.oss-cn-beijing.aliyuncs.com/pic/1686831479688.jpg",n.crossOrigin="Anonymous",n.onload=()=>{s.drawImage(n,0,0,c.current.width,c.current.height),e(!0)}}),h=()=>l.current.toDataURL("image/png"),v=()=>{s=c.current.getContext("2d");const{left:e,top:t}=c.current.getBoundingClientRect();p=e,m=t},w=()=>{o=l.current.getContext("2d"),o.fillStyle="black",o.fillRect(0,0,c.current.width,c.current.height)},x=async()=>{w(),v(),await f()};i.exports.useEffect(()=>{x()},[]);const C=e=>{if(r.current==="down")return;r.current="down";const{clientX:t,clientY:n}=e;let u=t-p,d=n-m;R(u,d)},y=e=>{if(r.current==="up")return;const{clientX:t,clientY:n}=e;let u=t-p,d=n-m;k(u,d)},I=e=>{console.log("onMouseUp"),r.current!=="up"&&(r.current="up",M())},R=(e,t)=>{s.strokeStyle="red",s.lineWidth=4,s.beginPath(),s.moveTo(e,t),o.strokeStyle="white",o.lineWidth=4,o.beginPath(),o.moveTo(e,t)},k=(e,t)=>{s.lineTo(e,t),s.stroke(),o.lineTo(e,t),o.stroke()},M=()=>{s.closePath(),o.closePath()};return g("div",{children:[a("section",{children:a("button",{onClick:()=>{const e=h(),t=new Image;t.src=e;const n=document.getElementById("img-wrapper");n==null||n.appendChild(t)},children:"\u5BFC\u51FA\u56FE\u7247"})}),g("section",{className:"content",children:[g("div",{className:"canvas-wrapper",children:[a("canvas",{className:"off-canvas",width:300,height:600,ref:l}),a("canvas",{className:"my-canvas",width:300,height:600,ref:c,onMouseDown:C,onMouseMove:y,onMouseUp:I})]}),a("div",{id:"img-wrapper"})]})]})};export{T as default};
