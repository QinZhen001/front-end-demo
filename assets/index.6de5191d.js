import{r as o,a as m,j as u}from"./index.b4813bcd.js";class d{constructor(t){this.$options=t,this.$data=t.data,this.$el=t.el,this.$binding={},this.proxyData(this.$data),new p(t.el,this)}proxyData(t){if(!t||typeof t!="object")return;const e=this,i={set(s,a,l){const n=Reflect.set(s,a,l);return e.$binding[a].map(r=>r.update()),n}};this.$data=new Proxy(t,i)}pushWatch(t){this.$binding[t.key]||(this.$binding[t.key]=[]),this.$binding[t.key].push(t)}}class p{constructor(t,e){this.$el=document.querySelector(t),this.$vm=e,this.$el&&(this.$fragment=this.getNodeChildren(this.$el),this.compile(this.$fragment),this.$el.appendChild(this.$fragment))}getNodeChildren(t){const e=document.createDocumentFragment();let i;for(;i=t.firstChild;)e.appendChild(i);return e}compile(t){const e=t.childNodes;Array.from(e).forEach(i=>{i.nodeType===1?this.compileElement(i):i.nodeType===2||i.nodeType===3&&this.compileText(i),i.childNodes&&i.childNodes.length&&this.compile(i)})}compileElement(t){const e=t.attributes;Array.from(e).forEach(i=>{const s=i.name,a=i.value;if(s.slice(0,2)==="z-"){var l=s.substring(2);switch(l){case"model":this.zDir_model(t,a);break;case"html":this.zDir_html(t,a);break}}})}compileText(t){if(typeof t.textContent!="string")return;const e=/{{(.*)}}/;let i=t.textContent.match(e);if(!i||!i.length||!i[1])return;const s=i[1].trim();this.updaterAll("text",t,s)}updaterAll(t,e,i){let s=null;switch(t){case"text":s=this.updateText;const a=e.textContent;s(e,this.$vm.$data[i],a),this.$vm.pushWatch(new c(this.$vm,i,a,function(n,r){s(e,n,r)}));break;case"model":s=this.updateModel;const l=this.$vm.$data[i];s(e,l),this.$vm.pushWatch(new c(this.$vm,i,null,function(n,r){s(e,n)}));break}}updateText(t,e,i){var s=/{{(.*)}}/gi,a=String(i.match(s)),l=i.replace(a,e);t.textContent=l}updateModel(t,e){t.value=e}zDir_model(t,e){const i=this.$vm;this.updaterAll("model",t,e),t.addEventListener("input",s=>{i.$data[e]=s.target.value})}zDir_html(t,e){this.updaterHtml(t,this.$vm.$data[e])}updaterHtml(t,e){t.innerHTML=e}}class c{constructor(t,e,i,s){this.vm=t,this.key=e,this.cb=s,this.initVal=i}update(){this.cb.call(this.vm,this.vm.$data[this.key],this.initVal)}}const $=()=>{o.exports.useEffect(()=>{h(),t()},[]);const h=()=>{let e=`
    <div>\u59D3\u540D\uFF1A{{ name }}</div>
    <div>{{ content }}</div>
    <div>
      <input type="text" z-model="name" placeholder="\u8BF7\u8F93\u5165\u81EA\u6211\u4ECB\u7ECD" />
    </div>
    <div z-html="htmlData"></div>`;document.querySelector("#app").innerHTML=e},t=()=>{const e=new d({el:"#app",data:{name:"someName",content:"someContent",htmlData:'<a href="#">some html</a>'}});window.vue=e,console.log("custom vue3: ",e)};return m("div",{children:["vue3",u("div",{id:"app"})]})};export{$ as default};
