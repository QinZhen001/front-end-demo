import{r as g,a as d,j as c}from"./index.e68da9fa.js";let t,s,a,n;const b=()=>{const o=g.exports.useRef(null),[i,u]=g.exports.useState(""),f=()=>{t=new RTCPeerConnection,a=t.createDataChannel("sendChannel"),a.onopen=r,a.onclose=r,s=new RTCPeerConnection,s.ondatachannel=R,t.onicecandidate=e=>!e.candidate||(s==null?void 0:s.addIceCandidate(e.candidate).catch(p)),s.onicecandidate=e=>!e.candidate||(t==null?void 0:t.addIceCandidate(e.candidate).catch(p)),t.createOffer().then(e=>(console.log("localConnection.createOffer() success"),t==null?void 0:t.setLocalDescription(e))).then(()=>s==null?void 0:s.setRemoteDescription(t.localDescription)).then(()=>s==null?void 0:s.createAnswer()).then(e=>s==null?void 0:s.setLocalDescription(e)).then(()=>t==null?void 0:t.setRemoteDescription(s.localDescription)).catch(D)},v=()=>{a==null||a.close(),n==null||n.close(),t==null||t.close(),s==null||s.close(),a=null,n=null,t=null,s=null},r=e=>{a&&(a.readyState=="open"?console.log("sendChannel is open"):console.log("sendChannel is closed"))},R=e=>{n=e.channel,n.onmessage=x,n.onopen=h,n.onclose=h},x=e=>{console.log("Received Message: "+e.data);const l=document.createElement("p"),C=document.createTextNode(e.data);l.appendChild(C),o.current.appendChild(l)},h=e=>{n&&console.log("Receive channel's status has changed to "+n.readyState)},p=e=>{console.error("Oh noes! addICECandidate failed!",e)},D=e=>{console.log("Unable to create an offer: "+e.toString())};return d("div",{children:[d("div",{children:[c("button",{onClick:f,children:"connectPeers"}),c("button",{onClick:v,children:"disconnectPeers"})]}),d("section",{style:{padding:"5px"},children:[c("div",{children:c("input",{value:i,onChange:e=>u(e.target.value)})}),c("button",{onClick:()=>{a==null||a.send(i)},children:"sendMessage"})]}),d("section",{style:{padding:"5px"},children:[c("div",{children:"Received Message: "}),c("div",{ref:o})]})]})};export{b as WebRtcDataChannel,b as default};
