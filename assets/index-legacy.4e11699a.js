!function(){var e=document.createElement("style");e.innerHTML=".content{display:flex;gap:24px}.canvas-wrapper{position:relative;width:300px;height:600px}.off-canvas{position:absolute;left:0;right:0;top:0;bottom:0;z-index:-1;visibility:hidden}.my-canvas{position:absolute;left:0;right:0;top:0;bottom:0;z-index:1;visibility:visible}\n",document.head.appendChild(e),System.register(["./index-legacy.b3d2934e.js"],(function(e){"use strict";var t,n,o;return{setters:[function(e){t=e.r,n=e.a,o=e.j}],execute:function(){let i,a=0,l=0,r="",c=new Map,s=[];window.operates=s,window.map=c;e("default",(()=>{const e=t.exports.useRef(null);let d=!1,h="",f=new Set;const g=(e,t)=>{const n=i.getImageData(e,t,1,1);var o=n.data[0],a=n.data[1],l=n.data[2];return"#"+(o<<16|a<<8|l).toString(16).padStart(6,"0")},p=async()=>{(()=>{i=e.current.getContext("2d",{willReadFrequently:!0});const{left:t,top:n}=e.current.getBoundingClientRect();a=t,l=n})(),await new Promise(((t,n)=>{const o=new Image;o.src="/images/color_block.jpg",o.crossOrigin="Anonymous",o.onload=()=>{i.drawImage(o,0,0,e.current.width,e.current.height),t(!0)}})),await(async()=>{let t=e.current.width,n=e.current.height,o=Date.now();for(let e=0;e<t-1;e++)for(let t=0;t<n-1;t++){let n=g(e,t);if(c.has(n))c.get(n).add([e,t]);else{let o=new Set;o.add([e,t]),c.set(n,o)}}for(let[e,a]of c)a.size<=100&&c.delete(e);let i=Date.now();console.log("cost time ",i-o),console.log("final map",c)})()};t.exports.useEffect((()=>{p()}),[]);const u=()=>{if(d)d=!1;else for(;s.length;){const{color:e,data:t}=s.pop()||{};if(e&&t){i.beginPath(),i.fillStyle=e;for(let e of t){const[t,n]=e;i.rect(t,n,1,1)}i.fill(),i.closePath()}}},m=()=>{if(!r)return;const e=c.get(r);h=function(e,t){var n=!1;"#"==e[0]&&(e=e.slice(1),n=!0);var o=parseInt(e,16),i=(o>>16)+t;i>255?i=255:i<0&&(i=0);var a=(o>>8&255)+t;a>255?a=255:a<0&&(a=0);var l=(255&o)+t;return l>255?l=255:l<0&&(l=0),(n?"#":"")+(l|a<<8|i<<16).toString(16)}(r,100),f=e,i.beginPath(),i.fillStyle=h;for(let t of e){const[e,n]=t;i.rect(e,n,1,1)}i.fill(),i.closePath(),s.push({color:r,data:e})};return n("div",{children:[o("section",{}),n("section",{className:"content",children:[n("div",{children:[o("h4",{children:"模特图"}),o("img",{src:"/images/model.jpg",width:"300",height:"600"})]}),n("div",{children:[o("h4",{children:"色块图（原图）"}),o("img",{src:"/images/color_block.jpg",width:"300",height:"600"})]}),n("div",{children:[o("h4",{children:"色块图（支持用户hover高亮，点击选中）"}),o("div",{className:"canvas-wrapper",children:o("canvas",{onMouseMove:e=>{let t=Math.floor(e.clientX-a),n=Math.floor(e.clientY-l);const o=g(t,n);r!==o&&(r=o,c.has(r)&&(u(),m()))},onMouseLeave:()=>{r="",u()},onClick:()=>{d=!0,i.beginPath(),i.fillStyle=h;for(let e of f){const[t,n]=e;i.rect(t,n,1,1)}i.fill(),i.closePath(),s.pop(),s.push({color:h,data:f})},className:"my-canvas",width:300,height:600,ref:e})})]})]})]})}))}}}))}();
