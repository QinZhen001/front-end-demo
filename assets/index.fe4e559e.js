import{r as g,a as l,j as c}from"./index.50dedc6c.js";var s,a,n,t;const b=()=>{const r=g.exports.useRef(null),[o,u]=g.exports.useState(""),v=()=>{s=new RTCPeerConnection,n=s.createDataChannel("sendChannel"),n.onopen=i,n.onclose=i,a=new RTCPeerConnection,a.ondatachannel=R,s.onicecandidate=e=>!e.candidate||(a==null?void 0:a.addIceCandidate(e.candidate).catch(p)),a.onicecandidate=e=>!e.candidate||(s==null?void 0:s.addIceCandidate(e.candidate).catch(p)),s.createOffer().then(e=>(console.log("localConnection.createOffer() success"),s==null?void 0:s.setLocalDescription(e))).then(()=>a==null?void 0:a.setRemoteDescription(s.localDescription)).then(()=>a==null?void 0:a.createAnswer()).then(e=>a==null?void 0:a.setLocalDescription(e)).then(()=>s==null?void 0:s.setRemoteDescription(a.localDescription)).catch(D)},f=()=>{n==null||n.close(),t==null||t.close(),s==null||s.close(),a==null||a.close(),n=null,t=null,s=null,a=null},i=e=>{if(n){var d=n.readyState;d=="open"?console.log("sendChannel is open"):console.log("sendChannel is closed")}},R=e=>{t=e.channel,t.onmessage=x,t.onopen=h,t.onclose=h},x=e=>{console.log("Received Message: "+e.data);var d=document.createElement("p"),C=document.createTextNode(e.data);d.appendChild(C),r.current.appendChild(d)},h=e=>{t&&console.log("Receive channel's status has changed to "+t.readyState)},p=e=>{console.error("Oh noes! addICECandidate failed!",e)},D=e=>{console.log("Unable to create an offer: "+e.toString())};return l("div",{children:[l("div",{children:[c("button",{onClick:v,children:"connectPeers"}),c("button",{onClick:f,children:"disconnectPeers"})]}),l("section",{style:{padding:"5px"},children:[c("div",{children:c("input",{value:o,onChange:e=>u(e.target.value)})}),c("button",{onClick:()=>{n==null||n.send(o)},children:"sendMessage"})]}),l("section",{style:{padding:"5px"},children:[c("div",{children:"Received Message: "}),c("div",{ref:r})]})]})};export{b as WebRtcDataChannel,b as default};
