import{j as f}from"./index.5bd7d4ed.js";const o=navigator.userAgent,r="ios",u="android";function g(e){window.addEventListener("pageshow",function(i){i.persisted&&e(i)},!1),document.addEventListener("visibilitychange",function(i){(document.visibilityState=="visible"||!document.hidden)&&e(i)},!1),document.addEventListener("webkitVisibilitychange",function(i){(document.webkitVisibilityState=="visible"||!document.webkitHidden)&&e(i)},!1)}function l(e){window.addEventListener("pagehide",function(i){i.persisted&&e(i)},!1),document.addEventListener("visibilitychange",function(i){(document.visibilityState=="hidden"||document.hidden)&&e(i)},!1),document.addEventListener("webkitVisibilitychange",function(i){(document.webkitVisibilityState=="hidden"||document.webkitHidden)&&e(i)},!1)}function v(){return!!/JSBridgeDemoUserAgent/.test(o)}function a(){var e={type:null,version:null};if(/\(i[^;]+;( U;)? CPU.+Mac OS X/.test(o)){e.type=r;var i=/\b[0-9]+_[0-9]+(?:_[0-9]+)?\b/.exec(o);i&&i[0]&&(e.version=i[0].replace(/_/g,"."))}else if(/Android/i.test(o)){e.type=u;var t=o.match(/Android\s+([\d\.]+)/i);e.version=t&&t[1]}else e.type=void 0;return e}const c={isJSBridgeAPPDemo:v(),device:a(),eventMap:{},uid:0,getDeviceId(e){this.deviceRouter("getDeviceId",null,e)},deviceRouter(e,i,t,s){if(!this.isJSBridgeAPPDemo)return console.log("isJSBridgeAPPDemo\uFF1Afalse"),!1;this.device.type==r?this.iosMethod(e,i,t,s):this.device.type==u?this.androidMethod(e,i,t,s):console.error("\u8BF7\u5728native\u7AEF\u4F7F\u7528\u6B64\u65B9\u6CD5\uFF1A"+e)},iosMethod(e,i,t,s){const d=this.uid;t&&(this.eventMap[e+d]=n=>{t&&t(n),s||delete this.eventMap[e+d]},this.uid++);try{const n={nativeMethod:e};t&&(n.callback=e+d),i&&(n.params=JSON.stringify(i)),window.webkit.messageHandlers.JSBridge.postMessage(n)}catch(n){console.error(JSON.stringify(n)),console.error("\u9700\u8981\u5728ios\u8BBE\u5907\u5185\u4F7F\u7528WKWebView")}},androidMethod(e,i,t,s){const d=this.uid;t&&(this.eventMap[e+d]=()=>{t&&t(data),s||delete this.eventMap[e+d]},this.uid++);try{i&&t?JSBridgeAndroid[e](JSON.stringify(i),e+d):i?JSBridgeAndroid[e](JSON.stringify(i)):t?JSBridgeAndroid[e](e+d):JSBridgeAndroid[e]()}catch(n){console.error(JSON.stringify(n)),console.error("\u9700\u8981\u5728android\u8BBE\u5907\u5185\u4F7F\u7528JSBridge\u529F\u80FD\uFF0C\u65E0\u5168\u5C40\u5BF9\u8C61JSBridgeAndroid")}},openPage(e){this.deviceRouter("openPage",{url:e},null),this.isJSBridgeAPPDemo||(location.href=e)},popPage(e){e||(e=1),this.deviceRouter("popPage",{step:e},null),this.isJSBridgeAPPDemo||(e==1?history.back():history.go(-e))},hideTitle(){this.deviceRouter("hideTitle",null,null)},showTitle(){this.deviceRouter("showTitle",null,null)},addResumeEvent(e){this.deviceRouter("addResumeEvent",null,e,!0),this.isJSBridgeAPPDemo||g(e)},addPauseEvent(e){this.deviceRouter("addPauseEvent",null,e,!0),this.isJSBridgeAPPDemo||l(e)}};console.log("JSBridge",c);const S=()=>f("div",{children:"JSBridgeComponent"});export{S as default};
