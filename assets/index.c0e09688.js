import{r as i,a as g,j as a}from"./index.b4813bcd.js";let c,o,m=0,p=0;const b=()=>{const r=i.exports.useRef(null),l=i.exports.useRef(null),s=i.exports.useRef("up"),f=()=>new Promise((e,t)=>{const n=new Image;n.src="/images/color_block.jpg",n.crossOrigin="Anonymous",n.onload=()=>{c.drawImage(n,0,0,r.current.width,r.current.height),e(!0)}}),h=()=>l.current.toDataURL("image/png"),v=()=>{c=r.current.getContext("2d");const{left:e,top:t}=r.current.getBoundingClientRect();m=e,p=t},w=()=>{o=l.current.getContext("2d"),o.fillStyle="black",o.fillRect(0,0,r.current.width,r.current.height)},x=async()=>{w(),v(),await f()};i.exports.useEffect(()=>{x()},[]);const C=e=>{if(s.current==="down")return;s.current="down";const{clientX:t,clientY:n}=e;let u=t-m,d=n-p;I(u,d)},k=e=>{if(s.current==="up")return;const{clientX:t,clientY:n}=e;let u=t-m,d=n-p;R(u,d)},y=e=>{console.log("onMouseUp"),s.current!=="up"&&(s.current="up",M())},I=(e,t)=>{c.strokeStyle="red",c.lineWidth=4,c.beginPath(),c.moveTo(e,t),o.strokeStyle="white",o.lineWidth=4,o.beginPath(),o.moveTo(e,t)},R=(e,t)=>{c.lineTo(e,t),c.stroke(),o.lineTo(e,t),o.stroke()},M=()=>{c.closePath(),o.closePath()};return g("div",{children:[a("section",{children:a("button",{onClick:()=>{const e=h(),t=new Image;t.src=e;const n=document.getElementById("img-wrapper");n==null||n.appendChild(t)},children:"\u5BFC\u51FA\u56FE\u7247"})}),g("section",{className:"content",children:[g("div",{className:"canvas-wrapper",children:[a("canvas",{className:"off-canvas",width:300,height:600,ref:l}),a("canvas",{className:"my-canvas",width:300,height:600,ref:r,onMouseDown:C,onMouseMove:k,onMouseUp:y})]}),a("div",{id:"img-wrapper"})]})]})};export{b as default};
