import{r as C,a as m,j as d}from"./index.b2acbfe7.js";let n,j=0,b=0,g="",h=new Map,w=[];window.operates=w;window.map=h;function M(r,s,l){var c="#"+(r<<16|s<<8|l).toString(16).padStart(6,"0");return c}function k(r,s){var l=!1;r[0]=="#"&&(r=r.slice(1),l=!0);var c=parseInt(r,16),p=(c>>16)+s;p>255?p=255:p<0&&(p=0);var v=(c>>8&255)+s;v>255?v=255:v<0&&(v=0);var f=(c&255)+s;return f>255?f=255:f<0&&(f=0),(l?"#":"")+(f|v<<8|p<<16).toString(16)}const R=()=>{const r=C.exports.useRef(null);let s=!1,l="",c=new Set;const p=()=>new Promise((e,o)=>{const t=new Image;t.src="https://fullapp.oss-cn-beijing.aliyuncs.com/pic/266631695719704_.pic.jpg",t.crossOrigin="Anonymous",t.onload=()=>{n.drawImage(t,0,0,r.current.width,r.current.height),e(!0)}}),v=()=>{n=r.current.getContext("2d",{willReadFrequently:!0});const{left:e,top:o}=r.current.getBoundingClientRect();j=e,b=o},f=(e,o)=>{const t=n.getImageData(e,o,1,1);var i=t.data[0],a=t.data[1],u=t.data[2];return M(i,a,u)},P=async()=>{let e=r.current.width,o=r.current.height,t=Date.now();for(let a=0;a<e-1;a++)for(let u=0;u<o-1;u++){let x=f(a,u);if(h.has(x))h.get(x).add([a,u]);else{let F=new Set;F.add([a,u]),h.set(x,F)}}for(let[a,u]of h)u.size<=100&&h.delete(a);let i=Date.now();console.log("cost time ",i-t),console.log("final map",h)},S=async()=>{v(),await p(),await P()};C.exports.useEffect(()=>{S()},[]);const E=e=>{let o=Math.floor(e.clientX-j),t=Math.floor(e.clientY-b);const i=f(o,t);g!==i&&(g=i,h.has(g)&&(y(),D()))},y=()=>{if(s){s=!1;return}for(;w.length;){const{color:e,data:o}=w.pop()||{};if(e&&o){n.beginPath(),n.fillStyle=e;for(let t of o){const[i,a]=t;n.rect(i,a,1,1)}n.fill(),n.closePath()}}},D=()=>{if(!g)return;const e=h.get(g);l=k(g,100),c=e,n.beginPath(),n.fillStyle=l;for(let o of e){const[t,i]=o;n.rect(t,i,1,1)}n.fill(),n.closePath(),w.push({color:g,data:e})};return m("div",{children:[d("section",{}),m("section",{className:"content",children:[m("div",{children:[d("h4",{children:"\u6A21\u7279\u56FE"}),d("img",{src:"https://fullapp.oss-cn-beijing.aliyuncs.com/pic/266571695718749_.pic.jpg",width:"300",height:"600"})]}),m("div",{children:[d("h4",{children:"\u8272\u5757\u56FE\uFF08\u539F\u56FE\uFF09"}),d("img",{src:"https://fullapp.oss-cn-beijing.aliyuncs.com/pic/266631695719704_.pic.jpg",width:"300",height:"600"})]}),m("div",{children:[d("h4",{children:"\u8272\u5757\u56FE\uFF08\u652F\u6301\u7528\u6237hover\u9AD8\u4EAE\uFF0C\u70B9\u51FB\u9009\u4E2D\uFF09"}),d("div",{className:"canvas-wrapper",children:d("canvas",{onMouseMove:E,onMouseLeave:()=>{g="",y()},onClick:()=>{s=!0,n.beginPath(),n.fillStyle=l;for(let e of c){const[o,t]=e;n.rect(o,t,1,1)}n.fill(),n.closePath(),w.pop(),w.push({color:l,data:c})},className:"my-canvas",width:300,height:600,ref:r})})]})]})]})};export{R as default};
